import{H as $}from"./HeaderComponent-qwhrUulW.js";import{A as L}from"./AsideComponent-15yF9K-s.js";import{L as A}from"./LoadingComponent-o0yFH_Z2.js";import{F as w}from"./FooterComponent-SD3s1sTL.js";import{P as N}from"./ProductCard-BwKCfyMu.js";import{_ as C,o as s,a as c,e,y as u,F as h,b as k,t as _,r as p,g as d,h as b,c as m}from"./index-Z_yqsO2Y.js";import"./FixedIcon-B3cRt8sP.js";const B={props:{pagination:{type:Object,default(){return{has_next:!1,current_page:1,total_pages:1,has_pre:!1}}}},emits:["page"]},F={class:"pagination justify-content-center align-items-center"},I=e("span",{"aria-hidden":"true"},"«",-1),j=[I],H=["onClick"],V=e("span",{"aria-hidden":"true"},"»",-1),T=[V];function q(n,o,a,r,t,g){return s(),c("ul",F,[e("li",{class:u(["page-item mx-1",a.pagination.has_pre?"d-block":"d-none"])},[e("button",{class:"page-link rounded-circle",type:"button","aria-label":"Previous",onClick:o[0]||(o[0]=i=>n.$emit("page",a.pagination.current_page-1))},j)],2),(s(!0),c(h,null,k(a.pagination.total_pages,i=>(s(),c("li",{class:u(["page-item mx-1",a.pagination.current_page===i?"active":""]),key:"page"+i},[e("button",{class:"page-link rounded-circle",href:"#",onClick:f=>n.$emit("page",i)},_(i),9,H)],2))),128)),e("li",{class:u(["page-item mx-1",a.pagination.has_next?"d-block":"d-none"])},[e("button",{class:"page-link rounded-circle",type:"button","aria-label":"Next",onClick:o[1]||(o[1]=i=>n.$emit("page",a.pagination.current_page+1))},T)],2)])}const z=C(B,[["render",q]]),D={components:{HeaderComponent:$,AsideComponent:L,ProductCard:N,LoadingComponent:A,FooterComponent:w,PageComponent:z},data(){return{isLoading:!1,products:[],tabs:["全部"],categoryItem:[],pagination:[],isAllProducts:!1}},inject:["changeTabs"],watch:{"$route.query":{handler(){this.getProducts()},deep:!0}},methods:{getProducts(n=1){this.isLoading=!0,this.tabs=["全部"];const o=this.$route.params.categoryName;let a="https://vue3-course-api.hexschool.io//v2/api/rongapi/products/all";o==="all"&&(a=`https://vue3-course-api.hexschool.io//v2/api/rongapi/products/?page=${n}`),this.axios.get(a).then(r=>{this.isLoading=!1,r.data.success?(o==="all"?(this.products=r.data.products,this.pagination=r.data.pagination,this.isAllProducts=!0):(this.products=r.data.products.filter(t=>t.title.match(o)),this.products.length===0&&(this.products=r.data.products.filter(t=>t.category.match(o)),this.products.length===0&&this.$swal.fire({icon:"error",text:"找不到此商品",showConfirmButton:!1,timer:1500}))),this.changeTabs(this.products,/[\u4e00-\u9fa5]/,this.tabs)):this.toast("error","尚未抓到資料")}).catch(r=>{this.isLoading=!1,this.toast("error","尚未抓到資料"),console.error("products-getProducts error",r)})},changeItem(n){this.categoryItem=this.products.filter(o=>o.category.match(n))}},created(){this.getProducts()}},E={class:"has-aside-layout has-header-layout"},O={class:"section-layout container text-center"},S={class:"py-40 py-lg-80"},G={class:"lh-lg m-0 text-primary ff-serif pb-4 text-uppercase"},J={key:0,class:"nav nav-pills flex-nowrap overflow-auto scrollBar-primary pb-2 pb-lg-40 justify-content-start justify-content-lg-center align-items-center",id:"pills-tab",role:"tablist"},K=["id","data-bs-target","onClick"],M={class:"container mt-4"};function Q(n,o,a,r,t,g){const i=p("HeaderComponent"),f=p("AsideComponent"),P=p("LoadingComponent"),y=p("ProductCard"),v=p("PageComponent"),x=p("FooterComponent");return s(),c(h,null,[d(i),d(f),d(P,{isLoading:t.isLoading},null,8,["isLoading"]),e("main",E,[e("section",O,[e("div",S,[e("h2",G,_(n.$route.params.categoryName),1),t.isAllProducts?b("",!0):(s(),c("ul",J,[(s(!0),c(h,null,k(t.tabs,l=>(s(),c("li",{class:"nav-item",role:"presentation",key:l},[e("button",{class:u(["nav-link text-nowrap px-3",l==="全部"?"active":""]),id:l,"data-bs-toggle":"pill","data-bs-target":l,type:"button",role:"tab","aria-controls":"pills-home","aria-selected":"true",onClick:R=>g.changeItem(l)},_(l),11,K)]))),128))])),e("div",M,[t.categoryItem.length<1?(s(),m(y,{key:0,products:t.products},null,8,["products"])):(s(),m(y,{key:1,products:t.categoryItem},null,8,["products"])),t.isAllProducts?(s(),m(v,{key:2,pagination:t.pagination,onPage:g.getProducts},null,8,["pagination","onPage"])):b("",!0)])])])]),d(x)],64)}const ot=C(D,[["render",Q]]);export{ot as default};
